<mxfile host="app.diagrams.net" modified="2025-08-03T00:00:00.000Z" agent="5.0" etag="command_recording_v1" version="24.6.4" type="device">
  <diagram name="Command Recording Flow" id="command-flow">
    <mxGraphModel dx="1422" dy="754" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title" value="Vulkan Command Recording Flow" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="280" y="20" width="300" height="30" as="geometry" />
        </mxCell>
        
        <!-- Frame Timeline -->
        <mxCell id="frame_start" value="Frame Start" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="100" y="80" width="100" height="40" as="geometry" />
        </mxCell>
        
        <!-- Command Pool Management -->
        <mxCell id="pool_reset" value="Reset Command Pool" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450" vertex="1" parent="1">
          <mxGeometry x="100" y="150" width="120" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="buffer_alloc" value="Allocate Command&#xa;Buffers" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450" vertex="1" parent="1">
          <mxGeometry x="250" y="140" width="120" height="40" as="geometry" />
        </mxCell>
        
        <!-- Recording Phase -->
        <mxCell id="begin_recording" value="Begin Recording" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="100" y="220" width="120" height="40" as="geometry" />
        </mxCell>
        
        <!-- Render Pass Management -->
        <mxCell id="begin_pass" value="Begin Render Pass" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366" vertex="1" parent="1">
          <mxGeometry x="100" y="300" width="120" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="viewport" value="Set Viewport&#xa;&amp; Scissor" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366" vertex="1" parent="1">
          <mxGeometry x="250" y="290" width="100" height="40" as="geometry" />
        </mxCell>
        
        <!-- Pipeline Binding -->
        <mxCell id="bind_pipeline" value="Bind Graphics&#xa;Pipeline" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf" vertex="1" parent="1">
          <mxGeometry x="100" y="370" width="120" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="bind_desc" value="Bind Descriptor&#xa;Sets" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf" vertex="1" parent="1">
          <mxGeometry x="250" y="370" width="120" height="40" as="geometry" />
        </mxCell>
        
        <!-- Resource Binding Loop -->
        <mxCell id="draw_loop" value="For Each Draw Call:" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="100" y="450" width="140" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="bind_vertex" value="Bind Vertex&#xa;Buffers" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00" vertex="1" parent="1">
          <mxGeometry x="120" y="500" width="100" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="bind_index" value="Bind Index&#xa;Buffer" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00" vertex="1" parent="1">
          <mxGeometry x="250" y="500" width="100" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="push_constants" value="Push Constants" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00" vertex="1" parent="1">
          <mxGeometry x="120" y="560" width="100" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="draw_indexed" value="Draw Indexed" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00" vertex="1" parent="1">
          <mxGeometry x="250" y="560" width="100" height="30" as="geometry" />
        </mxCell>
        
        <!-- End Recording -->
        <mxCell id="end_pass" value="End Render Pass" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366" vertex="1" parent="1">
          <mxGeometry x="100" y="620" width="120" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="end_recording" value="End Recording" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="100" y="680" width="120" height="40" as="geometry" />
        </mxCell>
        
        <!-- Submission -->
        <mxCell id="submit" value="Submit to Queue" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="100" y="750" width="120" height="40" as="geometry" />
        </mxCell>
        
        <!-- Parallel Structure -->
        <mxCell id="parallel_title" value="Parallel Recording Strategy" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="450" y="80" width="200" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="thread1" value="Thread 1&#xa;Shadow Pass" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0f8ff;strokeColor=#0066cc" vertex="1" parent="1">
          <mxGeometry x="450" y="130" width="80" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="thread2" value="Thread 2&#xa;Geometry Pass" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0f8ff;strokeColor=#0066cc" vertex="1" parent="1">
          <mxGeometry x="550" y="130" width="80" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="thread3" value="Thread 3&#xa;UI Pass" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0f8ff;strokeColor=#0066cc" vertex="1" parent="1">
          <mxGeometry x="650" y="130" width="80" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="sync_point" value="Synchronization Point" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcccc;strokeColor=#cc0000;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="500" y="220" width="160" height="30" as="geometry" />
        </mxCell>
        
        <!-- Error Handling -->
        <mxCell id="error_title" value="Error Handling" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="450" y="280" width="120" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="validation" value="Validation&#xa;Layers" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffeeee;strokeColor=#cc6666" vertex="1" parent="1">
          <mxGeometry x="450" y="320" width="80" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="debug_utils" value="Debug&#xa;Utils" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffeeee;strokeColor=#cc6666" vertex="1" parent="1">
          <mxGeometry x="550" y="320" width="80" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="error_recovery" value="Error&#xa;Recovery" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffeeee;strokeColor=#cc6666" vertex="1" parent="1">
          <mxGeometry x="650" y="320" width="80" height="40" as="geometry" />
        </mxCell>
        
        <!-- State Management -->
        <mxCell id="state_title" value="State Management" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="450" y="390" width="140" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="pipeline_cache" value="Pipeline&#xa;Cache" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#eef8ff;strokeColor=#6699cc" vertex="1" parent="1">
          <mxGeometry x="450" y="430" width="80" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="descriptor_pool" value="Descriptor&#xa;Pool" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#eef8ff;strokeColor=#6699cc" vertex="1" parent="1">
          <mxGeometry x="550" y="430" width="80" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="memory_pools" value="Memory&#xa;Pools" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#eef8ff;strokeColor=#6699cc" vertex="1" parent="1">
          <mxGeometry x="650" y="430" width="80" height="40" as="geometry" />
        </mxCell>
        
        <!-- Flow Arrows -->
        <mxCell id="flow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fillColor=#e1d5e7;strokeColor=#9673a6" edge="1" parent="1" source="frame_start" target="pool_reset">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;fillColor=#f8cecc;strokeColor=#b85450" edge="1" parent="1" source="pool_reset" target="buffer_alloc">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fillColor=#fff2cc;strokeColor=#d6b656" edge="1" parent="1" source="buffer_alloc" target="begin_recording">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="310" y="200" />
              <mxPoint x="160" y="200" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;fillColor=#d5e8d4;strokeColor=#82b366" edge="1" parent="1" source="begin_recording" target="begin_pass">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;fillColor=#d5e8d4;strokeColor=#82b366" edge="1" parent="1" source="begin_pass" target="viewport">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;fillColor=#dae8fc;strokeColor=#6c8ebf" edge="1" parent="1" source="viewport" target="bind_pipeline">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="300" y="350" />
              <mxPoint x="160" y="350" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;fillColor=#dae8fc;strokeColor=#6c8ebf" edge="1" parent="1" source="bind_pipeline" target="bind_desc">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fillColor=#ffe6cc;strokeColor=#d79b00" edge="1" parent="1" source="bind_desc" target="draw_loop">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="310" y="430" />
              <mxPoint x="170" y="430" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;fillColor=#ffe6cc;strokeColor=#d79b00" edge="1" parent="1" source="draw_loop" target="bind_vertex">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;fillColor=#ffe6cc;strokeColor=#d79b00" edge="1" parent="1" source="bind_vertex" target="bind_index">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;fillColor=#ffe6cc;strokeColor=#d79b00" edge="1" parent="1" source="bind_index" target="push_constants">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="300" y="540" />
              <mxPoint x="170" y="540" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;fillColor=#ffe6cc;strokeColor=#d79b00" edge="1" parent="1" source="push_constants" target="draw_indexed">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Loop back arrow -->
        <mxCell id="loop_back" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#d79b00;dashed=1" edge="1" parent="1" source="draw_indexed" target="draw_loop">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="380" y="575" />
              <mxPoint x="380" y="465" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;fillColor=#d5e8d4;strokeColor=#82b366" edge="1" parent="1" source="draw_indexed" target="end_pass">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="300" y="600" />
              <mxPoint x="160" y="600" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fillColor=#fff2cc;strokeColor=#d6b656" edge="1" parent="1" source="end_pass" target="end_recording">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fillColor=#e1d5e7;strokeColor=#9673a6" edge="1" parent="1" source="end_recording" target="submit">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Parallel connections -->
        <mxCell id="par1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;fillColor=#f0f8ff;strokeColor=#0066cc" edge="1" parent="1" source="thread1" target="sync_point">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="par2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;fillColor=#f0f8ff;strokeColor=#0066cc" edge="1" parent="1" source="thread2" target="sync_point">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="par3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;fillColor=#f0f8ff;strokeColor=#0066cc" edge="1" parent="1" source="thread3" target="sync_point">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Best Practices -->
        <mxCell id="practices" value="Best Practices:&#xa;• Reset pools per frame&#xa;• Validate state changes&#xa;• Batch similar operations&#xa;• Use push constants efficiently&#xa;• Minimize pipeline switches&#xa;• Profile command recording" style="text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="450" y="500" width="280" height="140" as="geometry" />
        </mxCell>
        
        <!-- Timing Labels -->
        <mxCell id="time1" value="~0.1ms" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;fontStyle=2;color=#666666" vertex="1" parent="1">
          <mxGeometry x="240" y="155" width="40" height="15" as="geometry" />
        </mxCell>
        
        <mxCell id="time2" value="~0.5ms" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;fontStyle=2;color=#666666" vertex="1" parent="1">
          <mxGeometry x="240" y="235" width="40" height="15" as="geometry" />
        </mxCell>
        
        <mxCell id="time3" value="~5ms" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;fontStyle=2;color=#666666" vertex="1" parent="1">
          <mxGeometry x="240" y="465" width="40" height="15" as="geometry" />
        </mxCell>
        
        <mxCell id="time4" value="~0.1ms" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;fontStyle=2;color=#666666" vertex="1" parent="1">
          <mxGeometry x="240" y="695" width="40" height="15" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
